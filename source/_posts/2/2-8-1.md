# 只执行一次的工作调度


(1)、at
	系统会将at工作独立出你的bash环境中，直接交给atd服务接管，因此at命令可以脱机继续工作，避免网络断线带来的困扰。
a、启动服务
at命令需要atd服务：
查看：
#ps-ef|grepatd
开启：
#/etc/init.d/atdstart
重启：
#/etc/init.d/atdrestart
设置atd服务开机启动：
#chkconfigatdon
chkconfig命令主要用来更新(启动或停止)和查询系统服务的运行级信息。谨记chkconfig不是立即自动禁止或激活一个服务,它只是简单的改变了符号连接。

S为下一次开机运行。
K为下一次开机不运行。
后面两位的数字为启动顺序。
b、查询当前工作调度：atq
#atq
c、添加一个工作调度：at
Ⅰ、命令功能：
在一个指定的时间执行一个指定任务，只能执行一次，且需要开启atd进程。
Ⅱ、命令格式：
#at[参数][时间]
#at-[mldv]TIME
#at-c工作号码
Ⅲ、命令参数：
-m当指定的任务被完成之后，即使没有标准输出，也以email通知用户工作完成。
-latq的别名
-datrm的别名
-v可以使用较为明显的格式勒出at调度的任务列表。
-c可以列出后面接的该项工作的实际命令内容。
TIME：时间格式，这里可以定义出什么时候要进行at这项任务的时间。
	at允许使用一套相当复杂的指定时间的方法。他能够接受在当天的hh:mm（小时:分钟）式的时间指定。假如该时间已过去，那么就放在第二天执行。当然也能够使用midnight（深夜），noon（中午），teatime（饮茶时间，一般是下午4点）等比较模糊的词语来指定时间。	用户还能够采用12小时计时制，即在时间后面加上AM（上午）或PM（下午）来说明是上午还是下午。也能够指定命令执行的具体日期，指定格式为monthday（月日）或mm/dd/yy（月/日/年）或dd.mm.yy（日.月.年）。指定的日期必须跟在指定时间的后面。
	上面介绍的都是绝对计时法，其实还能够使用相对计时法，这对于安排不久就要执行的命令是很有好处的。指定格式为：now+counttime-units，now就是当前时间，time-units是时间单位，这里能够是minutes（分钟）、hours（小时）、days（天）、weeks（星期）。count是时间的数量，究竟是几天，还是几小时，等等。更有一种计时方法就是直接使用today（今天）、tomorrow（明天）来指定完成命令的时间。就是说，在某个时间点再加几个时间后才进行该项任务。
TIME的格式有：
在今日的HH:MM时刻进行，若该时刻已超过，则明天的HH:MM进行此任务：
HH:MM								ex>04:00
强制规定在某年某月的某一天的特殊时刻进行该项任务：
HH:MMYYYY-MM-DD				ex>04:002009-03-17
HH:MM[am|pm][Month][Date]		ex>04pmMarch17
HH:MM[am|pm]+number[minutes|hours|days|weeks]
ex>now+5minutes
ex>04pm+3days
注：
	添加工作调度命令时，假使你的命令与文件或者工作目录有关，要使用绝对路径。防止atshell执行的工作目录和PATH里面找不到需要的文件。
d、删除已有的工作调度
#atrm5
删除5号任务。
e、为什么终端中不显示？
	这是由于at的执行与终端机的环境无关，所有的标准输入输出和错误输出都传送到执行者的mailbox中去了。如果你使用”/dev/tty1”登陆。则可以使用下列命令：
#atnow+1min
>echohello>“/dev/tty1”
>^D
如果你使用图形界面，那是在”/dev/pts/1”：
#atnow+1min
>echohello>“/dev/pts/1”
>^D
(2)、batch
batch与at命令使用方法相同，但是batch不用指定时间，应为它会自动在系统负载比较低的时候执行(平均负载小于0.8的时候)。
