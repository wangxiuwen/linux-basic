# 流程控制
(1)、选择
a、if控制
Ⅰ、if是单分支语句，使用格式如下：
ifcondition;then
statement
…..
fi
Ⅱ、if…else是双分支语句，使用格式如下：
ifcondition;then
statement
….
else
statement
….
fi
Ⅲ、if…elif…elif…else是多分支语句，使用格式如下：
ifcondition;then
statement
….
elifcondition;then
statement
…..
elifcondition;then
statement
…..
.
.
.
else
statement
….
fi
b、case控制
case也是循环语句，使用格式如下：
case$var(变量);in
value1）
……

value2)
…..

*)

..
..
..
esac

	case条件选择语句可根据字符串或变量值从多个选项中选择一项。
格式：
casestringin
Expr-1)
	..
	;;
Expr-2)
	..
	;;
*)
..
esac
例：
echo“******
pleaseselectyouroperation:
	press‘C’toCopy
	press‘D’toDelete
	press‘B’tobackup
readop
case$opin
	C)
	echo“yourselectionisCopy”
	;;
	D)
	B)
	*)
	echo“invalideselection”
esac
例：【select.case】
	a=5;b=3
	selectvarin“a+b”“a-b”“a*b”“a/b”
	do
		break
	done
	case$varin
	“a+b”)echo‘a+b=’`expr$a+$b`;;
						…
	*)echo“inputerror”
	esac

练习：
	1.编写注册程序，输入用户名，密码，邮箱，并对两次输入的密码作验证，判断两次输入是否一致。
	2.判断一个输入是否为目录。如果是，循环打印目录下内容;如果不是，输出错误提示。
	3.输入一个目录名称，列出目录内容并对当前目录做备份。
	4.批量添加用户1-29。
c、select控制
作用：
自动生成一个简单的文本菜单。
格式：
selectmenuin列表
	do
		..
	done
	列表可以是一个包含多个选项的变量，也可以是直接列在程序中的一组选项，如果没有列表，默认用位置变量。
【例】
	echo“whatisyourfavouriteOS?”
	selectvarin“Linux”“UNIX”“Windows”“Others”
	do
		break
	done
	echo“yourhaveselected$var”
(2)、循环
a、forin控制
对一个变量的可能取值都执行一个命令序列
格式：
for变量in取值列表
do
	命令列表
done
案例：
	1.输出1-5
	2.输出星期
练习：输出1-10的平方值
	列出所有参数
	目录下文件。
【循环打印参数列表】
	forvin$*
do
		echo$v
done
【循环打印当前目录下所有内容】
	forvin`ls`
	do
		echo$v
	done
练习：
判断一个输入是否为目录。如果是，循环打印目录下内容;如果不是，输出错误提示。
输入一个目录名称，列出目录内容并对当前目录做备份
b、while控制
	while语句是循环语句，当条件满足的情况下才循环，不满足则退出循环，用命令的返回值来控制循环，使用格式如下：
whilecondition;do
statement
…..
done
【案例：输出小于10的整数】
i=0
While[$i–lt10]
Do
	echo$i;i=`expr$i+1`
done
练习
1.计算1-100的和
2.批量添加用户
为用户导入密码：
echo123456|/usr/bin/passwd–stdin$name$n
c、until控制
	until语句也是循环语句，当条件不满足的情况下循环，满足则不循环，使用格式如下：
untilcondition;do
statement
…..
done
与while的区别在于，条件不成立时执行。
d、shift、break、continue语句
Shift语句：将存放在位置变量中的命令行参数依次向左传递。
例如：$1=file1$2=file2$3=file3,执行一次shift命令后，位置变量变为$1=file2$2=file3
移出后的参数不可再用
break:立即终止当前循环执行whilecase。
continue:终止当前循环，立即开始下一轮循环。
示例：
对参数列表累加求和：
while[$#-gt0]
do
sum=`expr$sum+$1`
Shift
done
echo$sum
e、goto语句
	goto语句是一个无条件的跳转语句，只要执行这个语句，程序指针就跳转到goto后标号所在的程序段
格式：
goto语句标号
	其中语句标号是一个带冒号的标识符。
(9)、bash编程中循环语句用法示例
脚本练习：
1.计算100以内所有能被3整除的正整数的和。
复制代码代码如下:
#!/bin/bash
declare-isum=0
forIin{1..100};do
if[$[$I%3]-eq0];then
letsum+=$I
fi
done
echo"thesumis:$sum"

2.计算100以内所有奇数的和以及所有偶数的和
复制代码代码如下:
#!/bin/bash
#echo"exercise"
declare-isum1=0
declare-isum2=0
forIin{1..100};do
if[$[$I%2]-eq0];then
letsum1+=$I
else
letsum2+=$I
fi
done
echo"theevensumis:$sum1"
echo"theoddnumbersumis:$sum2"

3.判断/var/log下的文件的类型：
如果是普通文件，则说明其为普通文件；
如果是目录文件，则说明其为目录文件；
如果是符号链接文件，则说明其为符号链接文件；
否则，说明文件类型无法识别；
代码如下：
#!/bin/bash
file1=/var/log/*
forfilein$file1;do
if[-f$file];then
echo"$fileiscommonfile"
elif[-d$file];then
echo"$fileisdirectoryfile"
else
echo"$fileisunknow"
fi
done

4.写一个脚本，分别显示当前系统上所有默认shell为bash的用户和默认shell为
/sbin/nologin的用户
并统计各类shell下的用户总数，显示结果形如：bash，3user，they
are：root，redhat，gentoonologn，2user，theyare：bin，ftp
复制代码代码如下:
#!/bin/bash
file=/etc/passwd
bsh='/bin/bash'
nobsh='/sbin/nologin'
use=`cat$file|cut-d:-f1`
declare-id1=0
declare-id2=0
forIin$use;do
s=`grep"^$I:"$file|cut-d:-f7`
if["$s"=$bsh];then
letd1=$d1+1
muser=$I\,$muser
elif["$s"=$nobsh];then
letd2=$d2+1
suser=$I\,$suser
fi
done
echo"BASH,$d1users,theyare:"
echo$muser
echo
echo"NOLOGIN,$d2users,theyare:"
echo$suser

5.写一个脚本：
(1)如果不存在，就创建文件/tmp/maintenance;如果存在，就事先删除
(2)在文件/tmp/maintenance中添加如下内容：
172.16.0.6
172.16.0.17
172.16.0.20
(3)测试172.16.0.0/16网络内的所有主机是否在线，如果在线就显示其在线，如果此主机在/tmp/maintenance文件中，就显示其正处于维护状态；否则，就显示其状态未知；
代码如下:
#!/bin/bash
file=/tmp/maintenace
if[-e$file];then
rm-rf$file&>/dev/null
fi
touch$file
cat>>$file<<EOF
172.16.0.6
172.16.0.17
172.16.0.20
EOF
bnet=172.16
fornetin{0..254};do
forhostin{1..254};do
ifping-c1-W1$bnet.$net.$host&>/dev/null;then
echo"$bnet.$net.$hostisup."
elifgrep"$bnet.$net.$host$"$file&>/dev/null;then
echo"$bnet.$net.$hostisundermaintenance."
else
echo"$bnet.$net.$hoststateisunknow."
fi
done
done

6写一个脚本，完成以下功能：
(1)、提示用户输入一个用户名；
(2)、显示一个菜单给用户，形如：
U|ushowUID
G|gshowGID
S|sshowSHELL
Q|qquit
(3)、提醒用户选择一个选项，并显示其所选择的内容；如果用户给的是一个非上述所提示的选项，则提醒用户给出的选项错误，并请其重新选择后执行；
第一种方法：
代码如下:
#!/bin/bash
read-p"Enterausername:"username
!id$username&>/dev/null&&echo"Comeon,theuseryouinputunexit"&&exit9
cat<<EOF
U|ushowUID
G|gshowGID
S|sshowSHELL
Q|qquit
EOF
read-p"Enteryourchoice:"op
case$opin
U|u)
id-u$username;;
G|g)
id-g$username;;
S|s)
grep"^$username\>"/etc/passwd|cut-d:-f7;;
Q|q)
exit8;;
*)
echo"inputoptionwrong,quit"
exit9

esac

第二种方法：
代码如下:
#!/bin/bash
read-p"Enterausername:"username
!id$username&>/dev/null&&echo"Comeon,youinputusernotexit"&&exit9
cat<<EOF
U|ushowUID
G|gshowGID
S|sshowSHELL
Q|qquit
EOF
read-p"Enteryouroption:"op
whiletrue;do
case$opin
U|u)
id-u$username
break

G|g)
id-g$username
break

S|s)
grep"^$username\>"/etc/passwd|cut-d:-f7
break

Q|q)
exit7;;
*)
read-p"Wrongoption,Enterarightoption:"op;;
esac
done
7写一个脚本：
(1)、判断一个指定的脚本是否是语法错误；如果有错误，则提醒用户键入Q或者q无视错误并退出，其它任何键可以通过vim打开这个指定的脚本；
(2)、如果用户通过vim打开编辑后保存退出时仍然有错误，则重复第1步中的内容；否则，就正常关闭退出。
第一种方法
复制代码代码如下:
#!/bin/bash
[!-f$1]&&echo"wrongpath."&&exit2
untilbash-n$1&>/dev/null;do
read-p"Q|qtoquit.otherstoedit:"opt
case$optin
Q|q)
echo"quit..."
exit3

*)
vim$1

esac
done

第二种方法：
代码如下:
#!/bin/bash
[!-f$1]&&echo"wrongpath."&&echo"Quit!"&&exit9
untilbash-n$1&>/dev/null;do
read-p"GrammarwrongpleaseenterQ|qtoquit.otherstoedit:"opt
case$optin
Q|q)
echo"quit..."
exit3

*)
vim$1
bash-n$1&>/dev/null
val=$?
["$val"-ne0]&&echo"xiugaibuchenggong."

esac
done

第三种方法
代码如下:
#!/bin/bash
[!-f$1]&&echo"Wrongscripts."&&exit4
bash-n$1&>/dev/null
valu=$?
until[$valu-eq0];do
read-p"Q|qtoquit,otherstoedit:"op
case$opin
Q|q)
echo"Quit."
exit9

*)
vim$1
bash-n$1&>/dev/null
valu=$?

esac
done

8写一个脚本：
查看redhat用户是否登录了系统，如果登录了，就通知当前脚本执行者“redhat
isloggedon.”；否则，就睡眠5秒钟后再次进行测试；直到其登录为止退出；
第一种方法
复制代码代码如下:
#!/bin/bash
who|grep"^redhat\>"&>/dev/null
reval=$?
until[$reval-eq0];do
sleep5
who|grep"^redhat\>"&>/dev/null
reval=$?
done
echo"redhatisloggedon."

第二种方法：
复制代码代码如下:
#!/bin/bash
untilwho|grep"^redhat\>"&>/dev/null;do
sleep5
done
echo"redhatisloggedon"

9写一个脚本：
(1)、向系统中添加20个用户，名字为linuxer1-linuxer20，密码分别为其用户名，要使用while循环；
(2)、要求：在添加每个用户之前事先判断用户是否存在，如果已经存在，则不再添加此用户；
(3)、添加完成后，显示linuxer1-linuxer20每个用户名及对应的UID号码和GID号码，形如stu1,UID:1000,GID:1000
复制代码代码如下:
#!/bin/bash
declare-iI=1
while[$I-le20];do
l=linuxer$I
letI++
!id$l&>/dev/null&&useradd$l&>/dev/null&&echo"theuser:$l"|passwd--stdin$l&>/dev/null&&echo"adduser$lsuccessfully"||echo"Theuser$lisexit."
d=`id-u$l`
g=`id-g$l`
echo"$l,UID:$d,GID:$g"
done
